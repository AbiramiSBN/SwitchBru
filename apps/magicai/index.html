<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Magic AI</title>
  <style>
/* Magic AI ‚Äî SwitchBru friendly UI
   Goals:
   - Big touch targets + readable fonts on TV/handheld (1280x720)
   - Avoid heavy CSS features (backdrop-filter, huge shadows)
   - Keep layout stable in older WebKit
*/

* { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
  height: 100%;
  background: #0b1020;
  color: #eaf0ff;
  font-family: Arial, Helvetica, sans-serif;
}

/* Subtle animated background */
.bg-particles {
  position: fixed;
  left: 0; top: 0; right: 0; bottom: 0;
  overflow: hidden;
  z-index: 0;
  background: radial-gradient(circle at 20% 10%, rgba(138,43,226,0.25), transparent 55%),
              radial-gradient(circle at 80% 80%, rgba(0,255,200,0.18), transparent 55%),
              linear-gradient(135deg, #0b1020, #060812);
}

.particle {
  position: absolute;
  width: 10px;
  height: 10px;
  border-radius: 10px;
  background: rgba(138, 43, 226, 0.45);
  animation: floaty 10s linear infinite;
  opacity: 0.9;
}

@keyframes floaty {
  0%   { transform: translateY(0) translateX(0); opacity: 0.15; }
  30%  { opacity: 0.9; }
  100% { transform: translateY(-120px) translateX(60px); opacity: 0.1; }
}

/* Main container */
.chat-wrapper {
  position: relative;
  z-index: 1;
  width: 94%;
  max-width: 1100px;
  height: 92vh;
  margin: 3vh auto;
  border-radius: 22px;
  border: 2px solid rgba(255,255,255,0.14);
  background: rgba(18, 22, 45, 0.92);
  box-shadow: 0 18px 40px rgba(0,0,0,0.55);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Header */
.chat-header {
  padding: 14px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid rgba(255,255,255,0.10);
  background: rgba(10, 12, 25, 0.65);
}

.chat-title {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 22px;
  font-weight: 800;
  letter-spacing: 0.3px;
}

.ai-indicator {
  width: 12px;
  height: 12px;
  border-radius: 10px;
  background: #2cffc7;
  box-shadow: 0 0 10px rgba(44,255,199,0.55);
}

/* Mode toggle (big & clicky) */
.mode-toggle {
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(56, 76, 160, 0.35);
  color: #eaf0ff;
  padding: 10px 14px;
  border-radius: 14px;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
}

.mode-toggle.search-active {
  background: rgba(44,255,199,0.18);
  border-color: rgba(44,255,199,0.35);
}

/* Messages */
.messages-container {
  flex: 1;
  padding: 14px 16px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.message {
  max-width: 92%;
  padding: 12px 14px;
  border-radius: 16px;
  margin: 10px 0;
  line-height: 1.35;
  font-size: 18px;
  word-wrap: break-word;
  border: 1px solid rgba(255,255,255,0.10);
}

.message.user {
  margin-left: auto;
  background: rgba(138,43,226,0.22);
  border-color: rgba(138,43,226,0.35);
}

.message.bot {
  margin-right: auto;
  background: rgba(255,255,255,0.06);
}

.message.search {
  margin-left: auto;
  background: rgba(44,255,199,0.14);
  border-color: rgba(44,255,199,0.30);
}

/* Typing indicator */
.typing-indicator {
  display: none;
  padding: 10px 16px 12px 16px;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  border-top: 1px solid rgba(255,255,255,0.10);
  background: rgba(10, 12, 25, 0.65);
  font-size: 16px;
  color: rgba(234,240,255,0.78);
}

.typing-dots { display: flex; gap: 6px; }
.dot {
  width: 8px; height: 8px;
  border-radius: 10px;
  background: rgba(234,240,255,0.85);
  animation: blink 1.2s infinite;
}
.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes blink {
  0%, 100% { opacity: 0.25; transform: translateY(0); }
  50%      { opacity: 1; transform: translateY(-2px); }
}

/* Input bar */
.input-container {
  display: flex;
  gap: 10px;
  padding: 12px 14px;
  border-top: 1px solid rgba(255,255,255,0.10);
  background: rgba(10, 12, 25, 0.65);
}

.input-field {
  flex: 1;
  padding: 12px 12px;
  border-radius: 14px;
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.06);
  color: #eaf0ff;
  font-size: 18px;
  outline: none;
}

.input-field:focus {
  border-color: rgba(44,255,199,0.45);
}

.send-btn {
  width: 56px;
  border-radius: 14px;
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(138,43,226,0.35);
  color: #eaf0ff;
  font-size: 20px;
  font-weight: 900;
  cursor: pointer;
}

/* Action buttons row */
.action-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  padding: 12px 14px 14px;
  border-top: 1px solid rgba(255,255,255,0.10);
  background: rgba(18, 22, 45, 0.92);
}

.action-btn {
  flex: 1 1 220px;
  padding: 12px 12px;
  border-radius: 16px;
  border: 2px solid rgba(255,255,255,0.14);
  background: rgba(56, 76, 160, 0.25);
  color: #eaf0ff;
  font-size: 16px;
  font-weight: 800;
  cursor: pointer;
}

.action-btn:active, .send-btn:active, .mode-toggle:active {
  transform: scale(0.99);
}

/* Modal */
.modal-overlay {
  display: none;
  position: fixed;
  z-index: 50;
  left: 0; top: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.55);
  align-items: center;
  justify-content: center;
  padding: 18px;
}

.modal {
  width: 96%;
  max-width: 900px;
  max-height: 86vh;
  border-radius: 20px;
  border: 2px solid rgba(255,255,255,0.14);
  background: rgba(18, 22, 45, 0.97);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.modal-header {
  padding: 12px 14px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid rgba(255,255,255,0.10);
}

.modal-title {
  font-size: 18px;
  font-weight: 900;
}

.close-btn {
  padding: 8px 10px;
  border-radius: 14px;
  border: 2px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.08);
  color: #eaf0ff;
  font-size: 16px;
  cursor: pointer;
}

.modal-content {
  padding: 12px 14px 14px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.search-input {
  width: 100%;
  padding: 12px 12px;
  border-radius: 14px;
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.06);
  color: #eaf0ff;
  font-size: 18px;
  outline: none;
  margin-bottom: 12px;
}

.kb-item {
  padding: 10px 12px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.05);
  margin-bottom: 10px;
}

.kb-q {
  font-weight: 900;
  color: rgba(44,255,199,0.95);
  margin-bottom: 6px;
}

.kb-a {
  color: rgba(234,240,255,0.92);
  font-size: 16px;
  line-height: 1.35;
}

.kb-empty {
  padding: 12px 12px;
  border-radius: 16px;
  border: 1px dashed rgba(255,255,255,0.18);
  color: rgba(234,240,255,0.80);
}

/* Small screens (handheld) */
@media (max-width: 760px) {
  .chat-wrapper { height: 94vh; margin: 2vh auto; }
  .message { font-size: 16px; }
  .input-field, .search-input { font-size: 16px; }
  .action-btn { flex-basis: 46%; }
}


/* Home button */
.home-btn {
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(255, 80, 80, 0.35);
  color: #eaf0ff;
  padding: 10px 12px;
  border-radius: 14px;
  font-weight: 800;
  cursor: pointer;
}
.home-btn:active { transform: scale(0.98); }

/* Calculator overlay (same style family as KB modal) */
.calc-overlay { display:none; position: fixed; inset: 0; background: rgba(0,0,0,0.65); z-index: 50; padding: 18px; }
.calc-modal {
  width: 94%;
  max-width: 520px;
  margin: 6vh auto 0;
  border-radius: 20px;
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(16, 24, 55, 0.92);
  box-shadow: 0 18px 40px rgba(0,0,0,0.55);
  overflow: hidden;
}
.calc-header { display:flex; align-items:center; justify-content:space-between; padding: 14px 14px 10px; }
.calc-title { font-size: 18px; font-weight: 900; }
.calc-close { border:none; background: rgba(255,255,255,0.10); color:#eaf0ff; border-radius: 12px; padding: 8px 12px; font-weight: 900; cursor:pointer; }
.calc-body { padding: 0 14px 14px; }
.calc-display {
  width:100%;
  padding: 14px 12px;
  border-radius: 16px;
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.06);
  color:#eaf0ff;
  font-size: 22px;
  font-weight: 900;
  letter-spacing: 0.3px;
}
.calc-grid { display:grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 12px; }
.calc-btn {
  padding: 14px 0;
  border-radius: 16px;
  border: 2px solid rgba(255,255,255,0.18);
  background: rgba(56, 76, 160, 0.28);
  color:#eaf0ff;
  font-size: 20px;
  font-weight: 900;
  cursor:pointer;
}
.calc-btn:active { transform: scale(0.98); }
.calc-btn.wide { grid-column: span 2; }

  </style>
</head>
<body>
  <div class="bg-particles" id="particles"></div>

  <div class="chat-wrapper">
    <div class="chat-header">
      <div class="chat-title">
        <span class="logo">‚ú®</span>
        <span>Magic AI</span>
      </div>
      <button id="mode-toggle" class="mode-toggle" type="button">üîé Search Mode</button>
    </div>

    <div class="messages" id="messages" aria-live="polite"></div>
    <div class="typing" id="typing" style="display:none;">Typing‚Ä¶</div>

    <div class="action-buttons">
      <button id="homeBtn" class="action-btn home-btn" type="button">üè† Redirect to Home</button>
      <button id="view-questions" class="action-btn" type="button">üìö View Knowledge</button>
      <button id="add-question" class="action-btn" type="button">‚ûï Add Knowledge</button>
      <button id="calculator" class="action-btn" type="button">üßÆ Calculator</button>
      <button id="clear-chat" class="action-btn" type="button">üßπ Clear Chat</button>
    </div>

    <div class="input-container" id="input-container">
      <input id="user-input" class="input-field" type="text" placeholder="Type a message‚Ä¶" autocomplete="off" />
      <button id="send-btn" class="send-btn" type="button">‚û§</button>
    </div>
  </div>

  <!-- Knowledge Base modal -->
  <div class="modal-overlay" id="modal-overlay" style="display:none;">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Knowledge Base">
      <div class="modal-header">
        <h2 class="modal-title">Knowledge Base</h2>
        <button class="close-btn" id="close-modal" type="button">‚úï</button>
      </div>
      <div class="modal-content">
        <input type="text" class="search-input" id="modal-search" placeholder="Search knowledge base...">
        <div id="questions-list"></div>
      </div>
    </div>
  </div>

  <!-- Calculator modal (single file) -->
  <div class="calc-overlay" id="calc-overlay" style="display:none;">
    <div class="calc-modal" role="dialog" aria-modal="true" aria-label="Calculator">
      <div class="calc-header">
        <div class="calc-title">Calculator</div>
        <button id="close-calc" class="calc-close" type="button">‚úï</button>
      </div>
      <div class="calc-body">
        <input id="calc-display" class="calc-display" type="text" inputmode="numeric" autocomplete="off" />
        <div class="calc-grid" id="calc-grid">
          <button class="calc-btn" data-act="clear">C</button>
          <button class="calc-btn" data-act="back">‚å´</button>
          <button class="calc-btn" data-act="append" data-val="(">(</button>
          <button class="calc-btn" data-act="append" data-val=")">)</button>

          <button class="calc-btn" data-act="append" data-val="7">7</button>
          <button class="calc-btn" data-act="append" data-val="8">8</button>
          <button class="calc-btn" data-act="append" data-val="9">9</button>
          <button class="calc-btn" data-act="append" data-val="/">√∑</button>

          <button class="calc-btn" data-act="append" data-val="4">4</button>
          <button class="calc-btn" data-act="append" data-val="5">5</button>
          <button class="calc-btn" data-act="append" data-val="6">6</button>
          <button class="calc-btn" data-act="append" data-val="*">√ó</button>

          <button class="calc-btn" data-act="append" data-val="1">1</button>
          <button class="calc-btn" data-act="append" data-val="2">2</button>
          <button class="calc-btn" data-act="append" data-val="3">3</button>
          <button class="calc-btn" data-act="append" data-val="-">‚àí</button>

          <button class="calc-btn wide" data-act="append" data-val="0">0</button>
          <button class="calc-btn" data-act="append" data-val=".">.</button>
          <button class="calc-btn" data-act="append" data-val="+">+</button>

          <button class="calc-btn wide" data-act="eval">=</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  // Embedded KB data (single-file build)
  window.EMBEDDED_KB_DATA = [{"question": "What is your name?", "answer": "My name is ChatBot."}, {"question": "What is programming?", "answer": "Programming is the process of writing instructions for computers."}, {"question": "What is a variable in programming?", "answer": "A variable is a storage location with a symbolic name that holds a value."}, {"question": "What is a function?", "answer": "A function is a block of code designed to perform a specific task."}, {"question": "What is C++?", "answer": "C++ is a high-performance programming language used for system/software development."}, {"question": "What is Python?", "answer": "Python is an interpreted, high-level language known for its readability and ease of use."}, {"question": "What is Java?", "answer": "Java is a popular, versatile, object-oriented programming language."}, {"question": "What is a loop?", "answer": "A loop repeatedly executes a block of code until a condition is met."}, {"question": "What is an array?", "answer": "An array is a collection of elements stored in contiguous memory."}, {"question": "What is object-oriented programming?", "answer": "It is a paradigm based on the concept of objects that contain data and methods."}, {"question": "How can I improve my programming skills?", "answer": "Practice daily, read code from others, and work on real projects."}, {"question": "What is software development?", "answer": "It is the process of designing, coding, testing, and maintaining software."}, {"question": "What are algorithms?", "answer": "Algorithms are step-by-step procedures for solving problems or performing tasks."}, {"question": "What is debugging?", "answer": "Debugging is the process of identifying and fixing errors in software."}, {"question": "What is a data structure?", "answer": "A data structure organizes and stores data for efficient access and modification."}, {"question": "What is a compiler?", "answer": "A compiler translates source code into machine code."}, {"question": "What is an interpreter?", "answer": "An interpreter executes code directly without prior compilation."}, {"question": "What is Git?", "answer": "Git is a distributed version control system for tracking code changes."}, {"question": "What is GitHub?", "answer": "GitHub is a platform for hosting and collaborating on Git repositories."}, {"question": "What is agile development?", "answer": "Agile development is an iterative approach that emphasizes flexibility and customer feedback."}, {"question": "What is a sprint in agile?", "answer": "A sprint is a fixed period during which a set amount of work is completed."}, {"question": "What is lifestyle?", "answer": "Lifestyle refers to the way a person lives, including habits, values, and attitudes."}, {"question": "How can I improve my lifestyle?", "answer": "Adopt healthy habits such as regular exercise, a balanced diet, and sufficient sleep."}, {"question": "What is mindfulness?", "answer": "Mindfulness is being fully present and aware of the moment."}, {"question": "How do I manage stress?", "answer": "Techniques include exercise, meditation, and proper time management."}, {"question": "What is meditation?", "answer": "Meditation is a practice to focus the mind and achieve mental clarity."}, {"question": "How do I develop a daily routine?", "answer": "Create a schedule that balances work, exercise, and leisure."}, {"question": "What is healthy eating?", "answer": "Healthy eating involves a balanced diet rich in fruits, vegetables, and whole grains."}, {"question": "Why is sleep important?", "answer": "Sleep is essential for physical recovery, mental health, and overall well-being."}, {"question": "What is work-life balance?", "answer": "It is the equilibrium between professional responsibilities and personal life."}, {"question": "How do I improve my time management?", "answer": "Prioritize tasks, set goals, and use planning tools like calendars."}, {"question": "What is writing?", "answer": "Writing is the process of expressing thoughts, ideas, or stories in written form."}, {"question": "How can I improve my writing skills?", "answer": "Practice regularly, read widely, and seek constructive feedback."}, {"question": "What is creative writing?", "answer": "Creative writing uses imagination to craft stories, poetry, or other narrative works."}, {"question": "What is a novel?", "answer": "A novel is a long fictional narrative that explores characters and themes."}, {"question": "What is poetry?", "answer": "Poetry uses rhythmic and aesthetic language to evoke emotions and ideas."}, {"question": "How do I overcome writer's block?", "answer": "Try freewriting, changing your environment, or taking a short break."}, {"question": "What is editing?", "answer": "Editing is the process of reviewing and refining written content for clarity and accuracy."}, {"question": "What is storytelling?", "answer": "Storytelling is the art of conveying a narrative through words, images, or sounds."}, {"question": "How do I build a narrative?", "answer": "Develop characters, establish conflict, and structure your plot logically."}, {"question": "What is web development?", "answer": "Web development involves creating and maintaining websites."}, {"question": "What is frontend development?", "answer": "Frontend development focuses on the user interface and user experience."}, {"question": "What is backend development?", "answer": "Backend development deals with server-side logic, databases, and application integration."}, {"question": "What is full-stack development?", "answer": "Full-stack development covers both frontend and backend aspects."}, {"question": "What is a database?", "answer": "A database is an organized collection of data that can be easily accessed and managed."}, {"question": "What is SQL?", "answer": "SQL is a language for managing and querying relational databases."}, {"question": "What is NoSQL?", "answer": "NoSQL databases are designed for large-scale data storage that does not require a fixed schema."}, {"question": "What is a REST API?", "answer": "A REST API allows communication between systems using standard HTTP methods."}, {"question": "What is JSON?", "answer": "JSON is a lightweight data-interchange format that is easy for humans to read and write."}, {"question": "What is XML?", "answer": "XML is a markup language that defines a set of rules for encoding documents."}, {"question": "What is machine learning?", "answer": "Machine learning uses algorithms to learn patterns from data."}, {"question": "What is deep learning?", "answer": "Deep learning is a subset of machine learning that uses neural networks with many layers."}, {"question": "What is data science?", "answer": "Data science involves extracting insights and knowledge from data using various techniques."}, {"question": "What is AI?", "answer": "Artificial intelligence is the simulation of human intelligence in machines."}, {"question": "What is natural language processing?", "answer": "NLP is the field of AI that focuses on the interaction between computers and human language."}, {"question": "What is big data?", "answer": "Big data refers to extremely large data sets that may be analyzed computationally to reveal patterns."}, {"question": "What is cloud computing?", "answer": "Cloud computing delivers computing services over the internet on a pay-as-you-go basis."}, {"question": "What is DevOps?", "answer": "DevOps is a set of practices that combines software development and IT operations."}, {"question": "What is a microservice?", "answer": "A microservice is a small, independent service that performs a single function in a larger application."}, {"question": "What is containerization?", "answer": "Containerization packages software in a way that it can run reliably across different computing environments."}, {"question": "What is Docker?", "answer": "Docker is a platform for developing, shipping, and running applications in containers."}, {"question": "What is Kubernetes?", "answer": "Kubernetes is an open-source system for automating the deployment and management of containerized applications."}, {"question": "What is responsive design?", "answer": "Responsive design ensures that web content adapts to different screen sizes and devices."}, {"question": "What is cybersecurity?", "answer": "Cybersecurity protects systems and networks from digital attacks."}, {"question": "What is ethical hacking?", "answer": "Ethical hacking is testing systems for vulnerabilities to improve security."}, {"question": "What is version control?", "answer": "Version control tracks changes to files and allows multiple people to work on them concurrently."}, {"question": "What is algorithm complexity?", "answer": "Algorithm complexity measures the efficiency of an algorithm in terms of time and space."}, {"question": "What is recursion?", "answer": "Recursion is a method where a function calls itself to solve a problem."}, {"question": "What is an IDE?", "answer": "An IDE is an Integrated Development Environment that provides tools to develop software."}, {"question": "What is continuous integration?", "answer": "Continuous integration is the practice of merging all developer working copies to a shared mainline several times a day."}, {"question": "What is continuous deployment?", "answer": "Continuous deployment automatically deploys code changes to production after passing tests."}, {"question": "How do I learn to code?", "answer": "Start with beginner-friendly tutorials and practice by building small projects."}, {"question": "What is object-oriented design?", "answer": "It is a method of design that organizes software around objects rather than functions."}, {"question": "What is functional programming?", "answer": "Functional programming treats computation as the evaluation of mathematical functions without changing state."}, {"question": "How do I become a better programmer?", "answer": "Practice consistently, learn new languages, and review code written by experienced developers."}, {"question": "What is the internet?", "answer": "The internet is a global network connecting millions of private, public, academic, business, and government networks."}, {"question": "What is blockchain?", "answer": "Blockchain is a decentralized, distributed ledger that records transactions across many computers."}, {"question": "What is cryptocurrency?", "answer": "Cryptocurrency is a digital asset that uses cryptography for secure transactions."}, {"question": "What is a smart contract?", "answer": "A smart contract is a self-executing contract with the terms directly written into code."}, {"question": "What is virtual reality?", "answer": "Virtual reality is an immersive, computer-generated environment that simulates a realistic experience."}, {"question": "What is augmented reality?", "answer": "Augmented reality overlays digital content onto the real world."}, {"question": "What is data mining?", "answer": "Data mining is the process of discovering patterns and knowledge from large data sets."}, {"question": "What is the role of a data scientist?", "answer": "A data scientist analyzes and interprets complex data to help inform business decisions."}, {"question": "What is big data analytics?", "answer": "It involves examining large and varied data sets to uncover hidden patterns and insights."}, {"question": "What is a framework in programming?", "answer": "A framework provides a standard way to build and deploy applications."}, {"question": "What is a library in programming?", "answer": "A library is a collection of precompiled routines that a program can use."}, {"question": "What is an API?", "answer": "API stands for Application Programming Interface, which allows software applications to interact with each other."}, {"question": "What is UI/UX design?", "answer": "UI/UX design focuses on creating user-friendly and aesthetically pleasing interfaces."}, {"question": "What is digital marketing?", "answer": "Digital marketing is the promotion of products or brands through digital channels."}, {"question": "What is social media?", "answer": "Social media platforms allow users to create and share content, and to interact with others."}, {"question": "What is e-commerce?", "answer": "E-commerce refers to buying and selling goods and services online."}, {"question": "What is SEO?", "answer": "SEO stands for Search Engine Optimization, which improves the visibility of a website."}, {"question": "What is a podcast?", "answer": "A podcast is a digital audio file available for streaming or download."}, {"question": "What is online education?", "answer": "Online education delivers learning content via the internet."}, {"question": "What is augmented reality?", "answer": "Augmented reality integrates digital information with the user‚Äôs environment in real time."}, {"question": "What is a startup?", "answer": "A startup is a company designed for rapid growth, often in innovative fields."}, {"question": "What is entrepreneurship?", "answer": "Entrepreneurship is the process of starting and running a new business."}, {"question": "What is a mentor?", "answer": "A mentor is an experienced advisor who helps guide someone‚Äôs career or personal growth."}, {"question": "What is networking?", "answer": "Networking is building relationships with others for professional or personal development."}, {"question": "What is a career?", "answer": "A career is an occupation or profession that a person engages in for a significant period of their life."}, {"question": "What is self-improvement?", "answer": "Self-improvement is the process of actively improving oneself through learning and personal growth."}, {"question": "What is goal setting?", "answer": "Goal setting is identifying what you want to achieve and outlining steps to accomplish it."}, {"question": "What is time management?", "answer": "Time management involves organizing your time efficiently to achieve your goals."}];
  </script>

  <script>
/* Magic AI ‚Äî SwitchBru-compatible (ES5) chat app
   - No classes / async/await / unicode-regex property escapes
   - Uses XHR (works on older WebKit)
   - Optional "Search Mode" uses Wikipedia (CORS-friendly via origin=*)
*/

(function () {
  'use strict';

  // ---------- Helpers ----------
  function $(id) { return document.getElementById(id); }

  function escapeHTML(str) {
    return String(str)
      .replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/"/g, '&quot;')
      .replace(/'/g, '&#39;');
  }

  // Normalize text: lowercase, strip most punctuation, compress spaces
  function normalize(str) {
    str = String(str || '').toLowerCase();
    // Replace anything that's not letter/number/space with space.
    // (Avoid unicode class escapes for old browsers.)
    str = str.replace(/[^a-z0-9\s]/g, ' ');
    str = str.replace(/\s+/g, ' ').replace(/^\s+|\s+$/g, '');
    return str;
  }


  // Lightweight math evaluator (ES5 + SwitchBru-friendly)
  function tryEvaluateMath(input) {
    var s = String(input || '');
    // Quick check: only math-y characters
    if (!s.replace(/\s+/g, '')) return null;

    // Allow digits, operators, parens, dot, spaces, and x/√ó for multiply
    if (!/^[0-9\.\+\-\*\/\^\(\)\s xX√ó]+$/.test(s)) return null;

    // Must contain at least one digit and at least one operator OR paren
    if (!/[0-9]/.test(s)) return null;
    if (!/[\+\-\*\/\^xX√ó\(\)]/.test(s)) return null;

    // Normalize multiply symbols
    s = s.replace(/√ó/g, '*').replace(/[xX]/g, '*');
    // Collapse spaces
    s = s.replace(/\s+/g, '');

    // Basic sanity: no repeated dots in a number like "1..2"
    if (/\.\./.test(s)) return null;

    try {
      var tokens = tokenizeMath(s);
      if (!tokens || !tokens.length) return null;
      var rpn = toRPN(tokens);
      var value = evalRPN(rpn);

      if (value === null || value === undefined) return null;
      if (typeof value !== 'number' || !isFinite(value)) return null;

      // Pretty formatting: trim very small floating errors
      var rounded = Math.round(value * 1000000000000) / 1000000000000;
      return { ok: true, expr: s, value: rounded };
    } catch (e) {
      return null;
    }
  }

  function tokenizeMath(s) {
    var out = [];
    var i = 0;
    var prevType = 'start'; // start|num|op|lparen|rparen

    while (i < s.length) {
      var ch = s.charAt(i);

      // Number: digits with optional decimal
      if ((ch >= '0' && ch <= '9') || ch === '.') {
        var j = i;
        var seenDot = false;
        while (j < s.length) {
          var c = s.charAt(j);
          if (c === '.') {
            if (seenDot) break;
            seenDot = true;
            j++;
            continue;
          }
          if (c >= '0' && c <= '9') { j++; continue; }
          break;
        }
        var numStr = s.slice(i, j);
        if (numStr === '.' || numStr === '') return null;
        out.push({ t: 'num', v: parseFloat(numStr) });
        i = j;
        prevType = 'num';
        continue;
      }

      // Parentheses
      if (ch === '(') {
        out.push({ t: 'lparen', v: ch });
        i++;
        prevType = 'lparen';
        continue;
      }
      if (ch === ')') {
        out.push({ t: 'rparen', v: ch });
        i++;
        prevType = 'rparen';
        continue;
      }

      // Operators
      if (ch === '+' || ch === '-' || ch === '*' || ch === '/' || ch === '^') {
        // Unary minus handling
        if (ch === '-' && (prevType === 'start' || prevType === 'op' || prevType === 'lparen')) {
          out.push({ t: 'op', v: 'u-' });
        } else {
          out.push({ t: 'op', v: ch });
        }
        i++;
        prevType = 'op';
        continue;
      }

      // Any other char -> not math
      return null;
    }

    return out;
  }

  function opInfo(op) {
    // precedence: higher wins
    if (op === 'u-') return { p: 4, a: 'right' };
    if (op === '^')  return { p: 3, a: 'right' };
    if (op === '*' || op === '/') return { p: 2, a: 'left' };
    if (op === '+' || op === '-') return { p: 1, a: 'left' };
    return { p: 0, a: 'left' };
  }

  function toRPN(tokens) {
    var output = [];
    var stack = [];

    for (var i = 0; i < tokens.length; i++) {
      var tok = tokens[i];

      if (tok.t === 'num') {
        output.push(tok);
        continue;
      }

      if (tok.t === 'op') {
        var o1 = tok.v;
        var o1i = opInfo(o1);

        while (stack.length) {
          var top = stack[stack.length - 1];
          if (top.t !== 'op') break;

          var o2 = top.v;
          var o2i = opInfo(o2);

          var shouldPop =
            (o1i.a === 'left'  && o1i.p <= o2i.p) ||
            (o1i.a === 'right' && o1i.p <  o2i.p);

          if (!shouldPop) break;
          output.push(stack.pop());
        }
        stack.push(tok);
        continue;
      }

      if (tok.t === 'lparen') {
        stack.push(tok);
        continue;
      }

      if (tok.t === 'rparen') {
        var found = false;
        while (stack.length) {
          var t = stack.pop();
          if (t.t === 'lparen') { found = true; break; }
          output.push(t);
        }
        if (!found) throw new Error('Mismatched parens');
        continue;
      }
    }

    while (stack.length) {
      var rem = stack.pop();
      if (rem.t === 'lparen' || rem.t === 'rparen') throw new Error('Mismatched parens');
      output.push(rem);
    }

    return output;
  }

  function evalRPN(rpn) {
    var st = [];
    for (var i = 0; i < rpn.length; i++) {
      var tok = rpn[i];

      if (tok.t === 'num') {
        st.push(tok.v);
        continue;
      }

      if (tok.t === 'op') {
        if (tok.v === 'u-') {
          if (st.length < 1) return null;
          st.push(-st.pop());
          continue;
        }

        if (st.length < 2) return null;
        var b = st.pop();
        var a = st.pop();

        if (tok.v === '+') st.push(a + b);
        else if (tok.v === '-') st.push(a - b);
        else if (tok.v === '*') st.push(a * b);
        else if (tok.v === '/') st.push(a / b);
        else if (tok.v === '^') st.push(Math.pow(a, b));
        else return null;
        continue;
      }

      return null;
    }

    if (st.length !== 1) return null;
    return st[0];
  }

  function xhrJSON(url, cb) {
    try {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', url, true);
      xhr.onreadystatechange = function () {
        if (xhr.readyState !== 4) return;
        if (xhr.status >= 200 && xhr.status < 300) {
          try { cb(null, JSON.parse(xhr.responseText)); }
          catch (e) { cb(e); }
        } else {
          cb(new Error('HTTP ' + xhr.status));
        }
      };
      xhr.send(null);
    } catch (e) { cb(e); }
  }

  function safeStorageGet(key) {
    try { return localStorage.getItem(key); } catch (e) { return null; }
  }
  function safeStorageSet(key, val) {
    try { localStorage.setItem(key, val); } catch (e) {}
  }

  // ---------- App ----------
  function MagicAI() {
    // DOM
    this.messagesEl = $('messages');
    this.userInput = $('user-input');
    this.sendBtn = $('send-btn');
    this.modeToggle = $('mode-toggle');
    this.typing = $('typing');
    this.inputContainer = $('input-container');

    this.modalOverlay = $('modal-overlay');
    this.closeModalBtn = $('close-modal');
    this.questionsList = $('questions-list');
    this.modalSearch = $('modal-search');

    // State
    this.isTyping = false;
    this.searchMode = false; // false=chat, true=search
    this.knowledgeBase = {}; // normalized question -> answer

    this.init();
  }

  MagicAI.prototype.init = function () {
    var self = this;

    // Load saved KB first
    var saved = safeStorageGet('aiKnowledgeBase');
    if (saved) {
      try { self.knowledgeBase = JSON.parse(saved) || {}; }
      catch (e) { self.knowledgeBase = {}; }
    } else {
      // Minimal defaults (fast + friendly)
      self.knowledgeBase = {
        'hello': "Hello! I'm Magic AI ‚ú®",
        'hi': "Hey there! üëã",
        'how are you': "All systems green. What can I help with?",
        'what can you do': "I can answer from my built‚Äëin knowledge base. Toggle Search Mode to look things up on Wikipedia.",
        'tell me a joke': "Why do programmers prefer dark mode? Because light attracts bugs. üêõ",
        'help': "Try: ‚Äúwhat is python‚Äù, ‚Äúwhat is azure‚Äù, or add your own Q&A with ‚ÄúAdd Knowledge‚Äù."
      };
      safeStorageSet('aiKnowledgeBase', JSON.stringify(self.knowledgeBase));
    }

    // Merge in embedded knowledge (single-file build)
    if (window.EMBEDDED_KB_DATA && window.EMBEDDED_KB_DATA.length) {
      var data = window.EMBEDDED_KB_DATA;
      for (var i = 0; i < data.length; i++) {
        var q = data[i] && data[i].question;
        var a = data[i] && data[i].answer;
        if (q && a) self.knowledgeBase[normalize(q)] = String(a);
      }
      safeStorageSet('aiKnowledgeBase', JSON.stringify(self.knowledgeBase));
    }

    // Bind events
    self.sendBtn.onclick = function () { self.handleSend(); };
    self.userInput.onkeypress = function (e) {
      e = e || window.event;
      var key = e.key || e.keyCode;
      if (key === 'Enter' || key === 13) self.handleSend();
    };
    self.modeToggle.onclick = function () { self.toggleMode(); };

    $('add-question').onclick = function () { self.addKnowledge(); };
    $('view-questions').onclick = function () { self.toggleModal(true); };
    $('calculator').onclick = function () { toggleCalc(true); };
    $('clear-chat').onclick = function () { self.clearChat(); };

    // SwitchBru Home
    if ($('homeBtn')) $('homeBtn').onclick = function () { window.location.href = 'https://switchbru2.vercel.app'; };

    if (self.closeModalBtn) self.closeModalBtn.onclick = function () { self.toggleModal(false); };
    if (self.modalOverlay) {
      self.modalOverlay.onclick = function (e) {
        if (e.target === self.modalOverlay) self.toggleModal(false);
      };
    }
    if (self.modalSearch) self.modalSearch.oninput = function () { self.renderKnowledgeList(self.modalSearch.value); };

    // Better Switch usability: auto-focus input on load
    setTimeout(function () { try { self.userInput.focus(); } catch (e) {} }, 120);

    // Start particles (cheap)
    createParticles(22);

    // Greeting
    self.addMessage('bot', "Welcome! Ask me something, or toggle **Search Mode** to look things up.");
    self.updateModeUI();
  };

  MagicAI.prototype.updateModeUI = function () {
    if (this.searchMode) {
      this.modeToggle.innerHTML = 'üí¨ Chat Mode';
      this.modeToggle.className = 'mode-toggle search-active';
      this.inputContainer.className = 'input-container search-mode';
    } else {
      this.modeToggle.innerHTML = 'üîç Search Mode';
      this.modeToggle.className = 'mode-toggle';
      this.inputContainer.className = 'input-container';
    }
  };

  MagicAI.prototype.toggleMode = function () {
    this.searchMode = !this.searchMode;
    this.updateModeUI();
    this.addMessage('bot', this.searchMode
      ? "Search Mode: I‚Äôll use Wikipedia. Try: ‚ÄúYosemite black bears‚Äù, ‚ÄúDatabricks‚Äù, ‚ÄúNintendo Switch‚Äù."
      : "Chat Mode: I‚Äôll answer from the saved knowledge base.");
  };

  MagicAI.prototype.showTyping = function () {
    this.isTyping = true;
    if (this.typing) this.typing.style.display = 'flex';
  };
  MagicAI.prototype.hideTyping = function () {
    this.isTyping = false;
    if (this.typing) this.typing.style.display = 'none';
  };

  MagicAI.prototype.addMessage = function (type, text) {
    var msg = document.createElement('div');
    msg.className = 'message ' + type;

    // Allow tiny markdown-ish bold for headers only (**text**)
    var safe = escapeHTML(text);
    safe = safe.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');

    msg.innerHTML = safe;
    this.messagesEl.appendChild(msg);

    // Scroll to bottom
    this.messagesEl.scrollTop = this.messagesEl.scrollHeight;
  };

  MagicAI.prototype.handleSend = function () {
    if (this.isTyping) return;
    var raw = this.userInput.value;
    if (!raw || !raw.replace(/\s+/g, '')) return;

    this.userInput.value = '';
    var norm = normalize(raw);

    if (this.searchMode) {
      this.addMessage('search', 'üîç ' + raw);
      this.performWikiSearch(raw);
    } else {
      this.addMessage('user', raw);

      // Quick math mode: type expressions like 8*9, 8/6, 8x6, (2+3)^2
      var mathRes = tryEvaluateMath(raw);
      if (mathRes && mathRes.ok) {
        this.addMessage('bot', 'üßÆ ' + mathRes.expr + ' = **' + mathRes.value + '**');
        return;
      }

      this.respond(norm);
}
  };

  MagicAI.prototype.respond = function (normText) {
    var self = this;
    self.showTyping();

    setTimeout(function () {
      var answer = self.knowledgeBase[normText];

      if (!answer) {
        // substring match (small KB)
        for (var k in self.knowledgeBase) {
          if (self.knowledgeBase.hasOwnProperty(k) && normText.indexOf(k) !== -1) {
            answer = self.knowledgeBase[k];
            break;
          }
        }
      }

      if (!answer) {
        answer = "I don‚Äôt have that saved yet. You can add it via **Add Knowledge**, or switch to **Search Mode**.";
      }

      self.addMessage('bot', String(answer));
      self.hideTyping();
    }, 350);
  };

  // Wikipedia search (2-step): opensearch -> summary
  MagicAI.prototype.performWikiSearch = function (query) {
    var self = this;
    self.showTyping();

    var url = 'https://en.wikipedia.org/w/api.php?action=opensearch&search=' +
      encodeURIComponent(query) +
      '&limit=1&namespace=0&format=json&origin=*';

    xhrJSON(url, function (err, data) {
      if (err || !data || !data[1] || !data[1][0]) {
        self.addMessage('bot', 'No result found. Try a shorter query.');
        self.hideTyping();
        return;
      }

      var title = data[1][0];
      var summaryUrl = 'https://en.wikipedia.org/api/rest_v1/page/summary/' + encodeURIComponent(title);

      xhrJSON(summaryUrl, function (err2, s) {
        if (err2 || !s) {
          self.addMessage('bot', 'Found "' + title + '", but couldn‚Äôt load details.');
          self.hideTyping();
          return;
        }

        var out = '';
        if (s.extract) out = s.extract;
        else if (s.description) out = title + ': ' + s.description;
        else out = 'Result: ' + title;

        // Add a short link (some Switch browsers show it nicely)
        if (s.content_urls && s.content_urls.desktop && s.content_urls.desktop.page) {
          out += '\n\n' + s.content_urls.desktop.page;
        }

        self.addMessage('bot', out);
        self.hideTyping();
      });
    });
  };

  MagicAI.prototype.clearChat = function () {
    this.messagesEl.innerHTML = '';
    this.addMessage('bot', 'Chat cleared.');
  };

  MagicAI.prototype.addKnowledge = function () {
    var q = prompt('Add a question (what the user will type):');
    if (!q) return;
    var a = prompt('Add the answer Magic AI should reply with:');
    if (!a) return;

    this.knowledgeBase[normalize(q)] = String(a);
    safeStorageSet('aiKnowledgeBase', JSON.stringify(this.knowledgeBase));
    this.addMessage('bot', 'Saved ‚úÖ');
  };

  MagicAI.prototype.toggleModal = function (open) {
    if (!this.modalOverlay) return;
    this.modalOverlay.style.display = open ? 'flex' : 'none';
    if (open) this.renderKnowledgeList('');
  };

  MagicAI.prototype.renderKnowledgeList = function (filterText) {
    if (!this.questionsList) return;

    var ft = normalize(filterText || '');
    var keys = [];
    for (var k in this.knowledgeBase) if (this.knowledgeBase.hasOwnProperty(k)) keys.push(k);
    keys.sort();

    var htmlStr = '';
    for (var i = 0; i < keys.length; i++) {
      var key = keys[i];
      if (ft && key.indexOf(ft) === -1) continue;
      var ans = this.knowledgeBase[key];
      htmlStr +=
        '<div class="kb-item">' +
          '<div class="kb-q">' + escapeHTML(key) + '</div>' +
          '<div class="kb-a">' + escapeHTML(ans) + '</div>' +
        '</div>';
    }

    if (!htmlStr) htmlStr = '<div class="kb-empty">No matches.</div>';
    this.questionsList.innerHTML = htmlStr;
  };

  // ---------- Particles (lightweight) ----------
  function createParticles(count) {
    var container = $('particles');
    if (!container) return;

    // Keep it cheap on Switch
    container.innerHTML = '';
    for (var i = 0; i < count; i++) {
      var p = document.createElement('div');
      p.className = 'particle';
      p.style.left = (Math.random() * 100) + '%';
      p.style.top = (Math.random() * 100) + '%';
      p.style.animationDelay = (Math.random() * 6) + 's';
      p.style.animationDuration = (7 + Math.random() * 7) + 's';
      container.appendChild(p);
    }
  }


  // ---------- Calculator (single-file) ----------
  function toggleCalc(show) {
    var ov = document.getElementById('calc-overlay');
    if (!ov) return;
    ov.style.display = show ? 'block' : 'none';
    if (show) {
      try { document.getElementById('calc-display').focus(); } catch (e) {}
    }
  }

  function calcAppend(ch) {
    var el = document.getElementById('calc-display');
    if (!el) return;
    el.value = (el.value || '') + ch;
  }

  function calcClear() {
    var el = document.getElementById('calc-display');
    if (el) el.value = '';
  }

  function calcBackspace() {
    var el = document.getElementById('calc-display');
    if (!el) return;
    el.value = (el.value || '').slice(0, -1);
  }

  function calcEval() {
    var el = document.getElementById('calc-display');
    if (!el) return;
    var expr = String(el.value || '').trim();
    if (!expr) return;

    // Allow only safe characters
    if (!/^[0-9+\-*/().\s]+$/.test(expr)) {
      el.value = 'ERR';
      return;
    }

    try {
      // eslint-disable-next-line no-new-func
      var out = Function('return (' + expr + ')')();
      if (typeof out === 'number' && isFinite(out)) {
        el.value = String(out);
      } else {
        el.value = 'ERR';
      }
    } catch (e) {
      el.value = 'ERR';
    }
  }

  // Boot
  document.addEventListener('DOMContentLoaded', function () {
    try { new MagicAI(); } catch (e) { /* noop */ }
    // Calculator bindings
    var co = document.getElementById('calc-overlay');
    var cc = document.getElementById('close-calc');
    if (cc) cc.onclick = function(){ toggleCalc(false); };
    if (co) co.onclick = function(e){ if (e.target === co) toggleCalc(false); };
    var grid = document.getElementById('calc-grid');
    if (grid) {
      grid.onclick = function(e){
        e = e || window.event;
        var t = e.target || e.srcElement;
        if (!t) return;
        var act = t.getAttribute('data-act');
        var val = t.getAttribute('data-val');
        if (act === 'append') calcAppend(val);
        else if (act === 'clear') calcClear();
        else if (act === 'back') calcBackspace();
        else if (act === 'eval') calcEval();
      };
    }

  });

}());

  </script>
</body>
</html>
